# Проектная работа "Веб-ларек"

Стек: HTML, SCSS, TS, Webpack

Структура проекта:
- src/ — исходные файлы проекта
- src/components/base/ — папка с базовым кодом

Важные файлы:
- src/pages/index.html — HTML-файл главной страницы
- src/types/index.ts — файл с типами
- src/index.ts — точка входа приложения
- src/styles/styles.scss — корневой файл стилей
- src/utils/constants.ts — файл с константами
- src/utils/utils.ts — файл с утилитами

## Установка и запуск
Для установки и запуска проекта необходимо выполнить команды

```
npm install
npm run start
```

или

```
yarn
yarn start
```
## Сборка

```
npm run build
```

или

```
yarn build
```
## Типы данных, используемые в приложении

Интерфейс API 
```
interface IRequest<T> {
  method: string;
  url: string;
  data?: T;
}

interface IResponse<T> {
  status: number;
  data: T | null;
}

interface IApi {
  request<T>(request: IRequest<T>): Promise<IResponse<T>>;
}
```
Карточка товара
```
interface ICardData {
  id?: string;
  description?: string;
  image: string;
  title: string;
  category: string;
  price: number|null;
}
```
Заказ и общая сумма к оплате
```
interface IOrder {
  items: Pick<ICardData, 'id' | 'title' | 'price'>[];
  totalPrice: number;
}
```

Функции, использующиеся при работе с корзиной покупок
```
interface IBasketOperations {
  calculateTotalPrice(): number;
  deleteItem(id: string): void;
  placeOrder(): void;
}
```
Форма оформления заказа: шаг 1, выбор оплаты и адреса
```
interface IPaymentForm {
  payment: string;
  address: string;

  selectPaymentMethod(method: 'online' | 'onDelivery'): void;
  enterAddress(inputAddress: string): void;
  submit(): void;
}
```
Форма оформления заказа: шаг 2, контакты покупателя
```
interface IContactsForm {
  email: string;
  phone: number;
  
  enterEmail(inputEmail: string): void;
  enterPhone(inputPhone: number): void;
  submit(): void;
}
```
Итоговая сумма покупки
```
type TTotalPrice = Pick<IOrder, 'totalPrice'>;
```
Массив товаров
```
type TCardsArray = ICardData[];
```
Общие данные пользователя
```
type TClient = IPaymentForm & IContactsForm;
```

## Архитектура приложения

Код приложения разделён на слои согласно MVC: 
- **Отображение**: визуализация данных на странице, 
- **Модель**: хранение и изменение данных
- **Контроллер**: связь отображения и данных.


### Слой данных

#### Класс CardApi
Класс отвечает за получение данных о товарах с сервера. При удачном ответе возвращает массив карточек. При сбое уведомляет об ошибке на сервере.

#### Класс ClientApi
Класс отвечает за отправку данных о клиенте на сервер.

#### Класс Card
Класс отвечает за хранение данных о товаре.

### Базовый код

#### Класс CardPopup
Класс используется при открытии модального окна карточки товара. Содержит в себе детальное описание.\
Также содержит в себе один метод для взаимодействия - **добавление товара в корзину** (происходит путём создания клона товара и помещение его в массив товаров корзины).

#### Класс Basket
Класс специализируется на составлении общего списка товаров путём создания массива. Содержит в себе следующие методы:
- **подсчёт общей суммы заказа**: перебирается каждый элемент массива, складываются значения по параметру `price`. Также учтена ситуация, когда стоимость товара будет приравнена к **нулю** при установленном ему ранее значении `null`.
- **удаление товара из корзины**: параметром функции передаётся `id` товара, с помощью которого вычисляется его индекс в массиве товаров корзины. При удалении товара сразу обновляется общая сумма заказа.
- **оформление заказа**: предусмотрена невозможность оформления при пустой корзине. Тем самым даже если корзина будет полна _бесценных_ товаров, чья стоимость равна нулю(`null`), оформление всё равно будет доступно. При успешном оформлении опустошается массив и обнуляется `totalPrice`.

#### Класс PaymentPopup
Класс используется при открытии модального окна оплаты. Осуществляется первый шаг оформления заказа: выбор способа оплаты и адреса доставки. Содержит методы:
- **выбор способа оплаты**: аргументом передаётся способ **(_онлайн/при получении_)**, который записывается в свойство `payment`.
- **заполнение поля "адрес"**: аргументом передаётся `строка` с адресом клиента, записывается в свойство `address`.
- **оправка формы**: при нажатии на кнопку `Далее` выполняется валидация полей.

#### Класс ContactsPopup
Класс использует данные покупателя для осуществления второго шага оформления заказа. Методы класса:
- **ввод адреса электронной почты**: аргументом передаётся `строка` с адресом электронной почты клиента, записывается в свойство `email`.
- **ввод номера телефона**: аргументом передаётся номер телефона клиента(`type: number`), который записывается в свойство `phone`.
- **отправка формы**: при нажатии на кнопку `Оплатить` выполняется валидация полей.

#### Класс SuccessfulOrder
Класс отвечает за уведомление клиента об успешном оформлении заказа. При открытии модального окна отображается сумма `totalPrice`, списанная со счёта.